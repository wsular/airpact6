# Install netCDF libraries {.unnumbered}

- The netCDF libraries for C and Fortran are needed. We chose to install [netcdf-c, version 4.8.1](https://github.com/Unidata/netcdf-c/releases/tag/v4.8.1) and [netcdf-fortran, version 4.5.2](https://github.com/Unidata/netcdf-fortran/releases/tag/v4.5.2) because both of these versions had been tested with CMAQ. In addition, we chose to install [parallel netCDF (pnetcdf), version 1.12.3](https://parallel-netcdf.github.io/wiki/Download.html) to allow parallel I/O. Here are the commands from the defintion file for loading all three libraries.

---

## netcdf-c

```
  #     netcdf-c
  export CC=mpicc
  export FC=mpifort
  export NCDIR=/usr/local
  export LD_LIBRARY_PATH=${NCDIR}/lib:${LD_LIBRARY_PATH}
  cd /opt/share
  #       Version used by CMAS
  wget https://github.com/Unidata/netcdf-c/archive/refs/tags/v4.8.1.tar.gz
  tar xvf v4.8.1.tar.gz
  cd netcdf-c-4.8.1
  ./configure --prefix=${NCDIR} --disable-netcdf-4 --disable-dap --disable-nczarr
  make check 
  make install
```

---

## netcdf-fortran

```
  cd /opt/share
  #       Version used by CMAS
  wget https://github.com/Unidata/netcdf-fortran/archive/refs/tags/v4.5.2.tar.gz
  tar xvf v4.5.2.tar.gz
  cd netcdf-fortran-4.5.2
  export LD_LIBRARY_PATH=${NCDIR}/lib:${LD_LIBRARY_PATH}
  export NFDIR=/usr/local
  export CPPFLAGS='-I${NCDIR}/include'
  export LDFLAGS='-L${NCDIR}/lib'
  export OMPI_FCFLAGS='-fallow-argument-mismatch'
  ./configure --prefix=${NFDIR} --disable-fortran-type-check
  make check
  make install
```

---

## pnetcdf

```
  #     pnetcdf
  cd /opt/share
  wget https://parallel-netcdf.github.io/Release/pnetcdf-1.12.3.tar.gz
  tar xvf pnetcdf-1.12.3.tar.gz
  cd pnetcdf-1.12.3
  ./configure --prefix=/opt/share/Pnetcdf MPICC=/usr/local/bin/mpicc MPICXX=/usr/local/bin/mpiCC MPIF77=/usr/local/bin/mpif77 MPIF90=/usr/local/bin/mpif90
  make
  make install
  ln -s /opt/share/Pnetcdf/lib/libpnetcdf.a /usr/local/lib/.
  ln -s /opt/share/Pnetcdf/lib/libpnetcdf.la /usr/local/lib/.
```

  - Note that it was necessary to create symbolic links from the pnetcdf installation directory to /usr/local/lib, to ensure that the libraries were on the library path.