Bootstrap: library
From: centos:7
Include: yum

%post
    # ....Important Linux packages
    yum -y install epel-release
    yum -y install bc
    yum -y install bison
    yum -y install bzip2
    yum -y install curl
    yum -y install cvs
    yum -y install ddd
    yum -y install dos2unix
    yum -y install file
    yum -y install flex
    yum -y install gcc
    yum -y install gcc-gfortran
    yum -y install gcc-c++
    yum -y install gd-devel
    yum -y install git
    yum -y install glibc-devel
    yum -y install gnuplot
    yum -y install hwloc hwloc-devel
#    yum -y install intel-basekit
    yum -y install ImageMagick
    yum -y install infiniband-diags-devel
    yum -y install jre
    yum -y install lzma lzma-devel
    yum -y install make
    yum -y install man
    yum -y install motif
    yum -y install mpich mpich-devel
    yum -y install mvapich2 mvapich2-devel
    yum -y install nano
    yum -y install openmpi3 openmpi3-devel
    yum -y install rcs
    yum -y install subversion
    yum -y install tcsh
    yum -y install time
    yum -y install unix2dos
    yum -y install wget
    yum -y install xguest
    yum -y install zlib zlib-devel

    # ....Extra packages for CMAQ compilation
    yum -y install grads
    yum -y install ncarg
    yum -y install ncview
    yum -y install nco
    yum -y install netcdf
    yum -y install netcdf-devel
    yum -y install netcdf-static
    yum -y install netcdf-cxx
    yum -y install netcdf-cxx-devel
    yum -y install netcdf-cxx-static
    yum -y install netcdf-fortran
    yum -y install netcdf-fortran-devel
    yum -y install netcdf-fortran-static
    yum -y install netcdf4-python

    # ....Create base directories for software installation
    mkdir /opt/bin
    mkdir /opt/share
    mkdir /opt/share/nedit

    # ....Install grib decoder for NCEP/NCAR reanalysis, etc. 
    mkdir /opt/wgrib
        cd /opt/wgrib
        wget ftp://ftp.cpc.ncep.noaa.gov/wd51we/wgrib/wgrib.c
        cc -o /opt/bin/wgrib wgrib.c

    # ....Install and compile ioapi (for use by CMAQ)
    export HOME="/opt"
    export BIN="Linux2_x86_64gfort_medium"
    cd /opt
    git clone https://github.com/cjcoats/ioapi-3.2.git
    cd /opt/ioapi-3.2; mkdir ${BIN} ; mkdir ${BIN}dbg
    cd /opt/ioapi-3.2/ioapi
    make -f Makefile.pncf
    make BIN=${BIN}dbg
    cd /opt/ioapi-3.2/m3tools
    make -f Makefile.pncf
    make BIN=${BIN}dbg            

%runscript
    echo "Container was created $NOW"
    echo "Arguments received: $*"
    exec echo "$@"

%startscript
    echo "Hello World!"

%test
    cat /etc/os-release

%labels
    Author Von P. Walden
    Version v0.0.1

%help
    This is a demo container used for AIRPACT-6 development.
